steps:
- checkout: none

- powershell: |
    try
    {
        $FullBuildNumber = "$(SemanticVersion).$(BuildRevision)"
        
        Write-Host "##vso[build.updatebuildnumber]$FullBuildNumber"
        Write-Host "##vso[task.setvariable variable=BuildNumber;isOutput=true]$(BuildRevision)"
        Write-Host "##vso[task.setvariable variable=FullVstsBuildNumber;isOutput=true]$FullBuildNumber"
        Write-Host "##vso[build.addbuildtag]$env:BUILD_SOURCEVERSIONAUTHOR"
        Write-Host "##vso[build.addbuildtag]$env:BUILD_SOURCEBRANCHNAME"

        Write-Host "BuildNumber='$(BuildRevision)'"
        Write-Host "FullVstsBuildNumber='$FullBuildNumber'"
    }
    catch
    {
        Write-Host "##vso[task.LogIssue type=error;]Unable to set build number"
        exit 1
    }
  displayName: "Update Build Number and Set Build Tags"
  name: updatebuildnumber
